mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_dnorm <- dnorm(x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_dnorm, type="l", col="red", lwd=2)
dev.off()
n <- 60
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_d <- dbinom(x=x, size=n, prob=p)
plot(x, re_d, type="h", xlab="k", ylab="PDF", main="normal approx. to binomial (PDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_dnorm <- dnorm(x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_dnorm, type="l", col="red", lwd=2)
dev.off()
n <- 60
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_pbinom <- pbinom(q=x, size=n, prob=p)
plot(x, re_pbinom, type="s", xlab="k", ylab="CDF", lwd=2, main="normal approx. to binomial (CDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_pnorm <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_pnorm, type="l", col="red", lwd=2)
dev.off()
n <- 60
p <- 0.3
x <- 9
re <- pbinom(q=x, size=n, prob=p)
mu <- n*p
sigma_squared <- n*p*(1-p)
re_appro <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
n <- 60
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_pbinom <- pbinom(q=x, size=n, prob=p)
plot(x, re_pbinom, type="s", xlab="k", ylab="CDF", lwd=2, main="normal approx. to binomial (CDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_pnorm <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_pnorm, type="l", col="red", lwd=2)
legend("topright", c("binomial", "normal"), col=c("black", "red")
dev.off()
n <- 60
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_pbinom <- pbinom(q=x, size=n, prob=p)
plot(x, re_pbinom, type="s", xlab="k", ylab="CDF", lwd=2, main="normal approx. to binomial (CDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_pnorm <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_pnorm, type="l", col="red", lwd=2)
legend("topright", c("binomial", "normal"), col=c("black", "red"))
dev.off()
n <- 60
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_pbinom <- pbinom(q=x, size=n, prob=p)
plot(x, re_pbinom, type="s", xlab="k", ylab="CDF", lwd=2, main="normal approx. to binomial (CDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_pnorm <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_pnorm, type="l", col="red", lwd=2)
legend("topright", c("binomial", "normal"), col=c("black", "red"), lty=c(2,2))
dev.off()
n <- 60
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_pbinom <- pbinom(q=x, size=n, prob=p)
plot(x, re_pbinom, type="s", xlab="k", ylab="CDF", lwd=2, main="normal approx. to binomial (CDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_pnorm <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_pnorm, type="l", col="red", lwd=2)
legend("topright", c("binomial", "normal"), col=c("black", "red"), lty=c(1,1), lwd=c(2,2))
dev.off()
?legend
n <- 60
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_pbinom <- pbinom(q=x, size=n, prob=p)
plot(x, re_pbinom, type="s", xlab="k", ylab="CDF", lwd=2, main="normal approx. to binomial (CDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_pnorm <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_pnorm, type="l", col="red", lwd=2)
legend(50,0.8, c("binomial", "normal"), col=c("black", "red"), lty=c(1,1), lwd=c(2,2))
dev.off()
n <- 60
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_pbinom <- pbinom(q=x, size=n, prob=p)
plot(x, re_pbinom, type="s", xlab="k", ylab="CDF", lwd=2, main="normal approx. to binomial (CDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_pnorm <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_pnorm, type="l", col="red", lwd=2)
legend(40,0.9, c("binomial", "normal"), col=c("black", "red"), lty=c(1,1), lwd=c(2,2))
dev.off()
n <- 60
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_pbinom <- pbinom(q=x, size=n, prob=p)
plot(x, re_pbinom, type="s", xlab="k", ylab="CDF", lwd=2, main="normal approx. to binomial (CDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_pnorm <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_pnorm, type="l", col="red", lwd=2)
legend(45,0.9, c("binomial", "normal"), col=c("black", "red"), lty=c(1,1), lwd=c(2,2))
dev.off()
mu <- 5
sigma <- 0.5
x <- seq(from=-4, to=8, by=0.1)
density_1 <- dnorm(x, mean=0, sd=1)
density_2 <- dnorm(x, mean=mu, sd=sigma)
pdf("/Users/xdu4/Downloads/normal.pdf")
plot(x, density_1, type="l", col="red")
points(x, density_2, type="l", col="black")
dev.off()
mu <- 5
sigma <- 0.5
x <- seq(from=-5, to=9, by=0.1)
density_1 <- dnorm(x, mean=0, sd=1)
density_2 <- dnorm(x, mean=mu, sd=sigma)
pdf("/Users/xdu4/Downloads/normal.pdf")
plot(x, density_1, type="l", col="red", xlab="x", ylab="PDF", xlim=c(min(x), max(x)), ylab=c(0, max(c(density_1, density_2))))
points(x, density_2, type="l", col="black")
dev.off()
mu <- 5
sigma <- 0.5
x <- seq(from=-5, to=9, by=0.1)
density_1 <- dnorm(x, mean=0, sd=1)
density_2 <- dnorm(x, mean=mu, sd=sigma)
pdf("/Users/xdu4/Downloads/normal.pdf")
plot(x, density_1, type="l", col="red", xlab="x", ylab="PDF", xlim=c(min(x), max(x)), ylim=c(0, max(c(density_1, density_2))))
points(x, density_2, type="l", col="black")
dev.off()
mu <- 5
sigma <- 0.5
x <- seq(from=-5, to=9, by=0.1)
density_1 <- dnorm(x, mean=0, sd=1)
density_2 <- dnorm(x, mean=mu, sd=sigma)
pdf("/Users/xdu4/Downloads/normal.pdf")
plot(x, density_1, type="l", col="red", xlab="x", ylab="PDF", xlim=c(min(x), max(x)), ylim=c(0, max(c(density_1, density_2))), lwd=2)
points(x, density_2, type="l", col="black", lwd=2)
dev.off()
mu <- 7
sigma <- 0.5
x <- seq(from=-5, to=11, by=0.1)
density_1 <- dnorm(x, mean=0, sd=1)
density_2 <- dnorm(x, mean=mu, sd=sigma)
pdf("/Users/xdu4/Downloads/normal.pdf")
plot(x, density_1, type="l", col="red", xlab="x", ylab="PDF", xlim=c(min(x), max(x)), ylim=c(0, max(c(density_1, density_2))), lwd=2)
points(x, density_2, type="l", col="black", lwd=2)
dev.off()
mu <- 8
sigma <- 0.5
x <- seq(from=-5, to=12, by=0.1)
density_1 <- dnorm(x, mean=0, sd=1)
density_2 <- dnorm(x, mean=mu, sd=sigma)
pdf("/Users/xdu4/Downloads/normal.pdf")
plot(x, density_1, type="l", col="red", xlab="x", ylab="PDF", xlim=c(min(x), max(x)), ylim=c(0, max(c(density_1, density_2))), lwd=2)
points(x, density_2, type="l", col="black", lwd=2)
dev.off()
x <- 7
z <- (x-mu)/sigma
?pnorm()
p <- 0.877
z <- qnorm(p, mean=0, sd=1)
p <- 0.8621
z <- qnorm(p, mean=0, sd=1)
a1 <- pnorm(-1.5, mean=0, sd=1)
a2 <- a1 +0.0217
z <- qnorm(p=a2, mean=0, sd=1)
a1 <- pnorm(-1.5, mean=0, sd=1)
a2 <- a1 - 0.0217
z <- qnorm(p=a2, mean=0, sd=1)
mu <- 8
sigma <- 0.5
p <- 0.877
z <- qnorm(p, mean=mu, sd=sigma)
z <- qnorm(0.8621, mean=mu, sd=sigma)
a1 <- pnorm(7, mean=mu, sd=sigma)
a1 <- pnorm(-1.5, mean=0, sd=1)
a1 <- pnorm(-1.5, mean=0, sd=1)
a2 <- a1 - 0.0217
z <- qnorm(p=a2, mean=0, sd=1)
a2 <- a1 + 0.0217
z <- qnorm(p=a2, mean=0, sd=1)
a1 <- pnorm(6, mean=mu, sd=sigma)
a1 <- pnorm(7.5, mean=mu, sd=sigma)
a1 <- pnorm(7.5, mean=mu, sd=sigma)
a2 <- a1 - 0.0217
z <- qnorm(a2, mean=mu, sd=sigma)
a2 <- a1 + 0.0217
z <- qnorm(a2, mean=mu, sd=sigma)
725+217+61+30+50
43.74-12.25
438.35-355.01
83.34*6
1-(0.2-0.01)
re <- choose(20,3)*(0.7)^3*(0.3)^17
re
?dbinom()
k <- 3
n <- 20
p <- 0.7
re <- dbinom(x=k, size=n, prob=p)
re <- pbinom(q=3, size=n, prob=p)
re <- 1 - pbinom(q=4, size=n, prob=p)
re <- pbinom(q=15, size=n, prob=p) - pbinom(q=9, size=n, prob=p)
re <- 1 - pbinom(q=4, size=n, prob=p)
?dpois
e
exp(1)
my_dpois <- function(k, lambda) {
prob <- lambda^k / factorial(k) * exp(-lambda)
return(prob)
}
lam <- 10
k <- 12
re <- my_dpois(k=k, lambda=lam)
re2 <- dpois(x=k, lambda=lam)
mu <- 8
sigma <- 0.5
x <- seq(from=-5, to=12, by=0.1)
density_1 <- dnorm(x, mean=0, sd=1)
density_2 <- dnorm(x, mean=mu, sd=sigma)
pdf("/Users/xdu4/Downloads/normal.pdf")
plot(x, density_1, type="l", col="red", xlab="x", ylab="PDF", xlim=c(min(x), max(x)), ylim=c(0, max(c(density_1, density_2))), lwd=2)
points(x, density_2, type="l", col="black", lwd=2)
dev.off()
?pnorm()
re <- pnorm(q=x, mean=mu, sd=sigma)
re
x <- 7
re <- pnorm(q=x, mean=mu, sd=sigma)
mu <- 8
sigma <- 0.5
x <- 7
re <- pnorm(q=x, mean=mu, sd=sigma)
re
z <- (x-mu)/sigma
re_z <- pnorm(p=z, mean=0, sd=1)
z <- (x-mu)/sigma
re_z <- pnorm(p=z, mean=0, sd=1)
re_z <- pnorm(q=z, mean=0, sd=1)
f<-function(x){dnorm(x,1.9,0.5)}
plot(f,0,4,xlab="x-axis",ylab="density f(x)")
f
?plot
?polygon
x<-seq(0,2,0.5)
polygon(c(0,x,2), c(0,f(x),0), col="lightblue")
x<-seq(0,2.1,0.7)
polygon(c(0,x,2.1), c(0,f(x),0), col="lightblue")
graphics.off()
x<-seq(0,2.1,0.7)
polygon(c(0,x,2.1), c(0,f(x),0), col="lightblue")
f<-function(x){dnorm(x,1.9,0.5)}
plot(f,0,4,xlab="x-axis",ylab="density f(x)")
x<-seq(0,2.1,0.7)
polygon(c(0,x,2.1), c(0,f(x),0), col="lightblue")
?polygon
298.3-172.68+160-112
2396.2-1772.7
298.3-172.68+160-112-900
174*2
625*2
?plot
n <- 5
p <- 0.5
x <- 0:n
re <- dbinom(x, size=n, prob=p)
plot(x, re, type="h")
n <- 3
p <- 0.5
x <- 0:n
re <- dbinom(x, size=n, prob=p)
plot(x, re, type="h")
n <- 20
p <- 0.5
x <- 0:n
re <- dbinom(x, size=n, prob=p)
plot(x, re, type="h")
n <- 20
p <- 0.1
x <- 0:n
re <- dbinom(x, size=n, prob=p)
plot(x, re, type="h")
n <- 20
p <- 0.2
x <- 0:n
re <- dbinom(x, size=n, prob=p)
plot(x, re, type="h")
n <- 20
p <- 0.3
x <- 0:n
re <- dbinom(x, size=n, prob=p)
plot(x, re, type="h")
n <- 40
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_pbinom <- pbinom(q=x, size=n, prob=p)
plot(x, re_pbinom, type="s", xlab="k", ylab="CDF", lwd=2, main="normal approx. to binomial (CDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_pnorm <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_pnorm, type="l", col="red", lwd=2)
legend(45,0.9, c("binomial", "normal"), col=c("black", "red"), lty=c(1,1), lwd=c(2,2))
dev.off()
n <- 30
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_pbinom <- pbinom(q=x, size=n, prob=p)
plot(x, re_pbinom, type="s", xlab="k", ylab="CDF", lwd=2, main="normal approx. to binomial (CDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_pnorm <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_pnorm, type="l", col="red", lwd=2)
legend(45,0.9, c("binomial", "normal"), col=c("black", "red"), lty=c(1,1), lwd=c(2,2))
dev.off()
n <- 30
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_d <- dbinom(x=x, size=n, prob=p)
plot(x, re_d, type="h", xlab="k", ylab="PDF", main="normal approx. to binomial (PDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_dnorm <- dnorm(x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_dnorm, type="l", col="red", lwd=2)
dev.off()
n <- 20
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_d <- dbinom(x=x, size=n, prob=p)
plot(x, re_d, type="h", xlab="k", ylab="PDF", main="normal approx. to binomial (PDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_dnorm <- dnorm(x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_dnorm, type="l", col="red", lwd=2)
dev.off()
n <- 20
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_pbinom <- pbinom(q=x, size=n, prob=p)
plot(x, re_pbinom, type="s", xlab="k", ylab="CDF", lwd=2, main="normal approx. to binomial (CDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_pnorm <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_pnorm, type="l", col="red", lwd=2)
legend(45,0.9, c("binomial", "normal"), col=c("black", "red"), lty=c(1,1), lwd=c(2,2))
dev.off()
n <- 100
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_d <- dbinom(x=x, size=n, prob=p)
plot(x, re_d, type="h", xlab="k", ylab="PDF", main="normal approx. to binomial (PDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_dnorm <- dnorm(x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_dnorm, type="l", col="red", lwd=2)
dev.off()
n <- 100
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_pbinom <- pbinom(q=x, size=n, prob=p)
plot(x, re_pbinom, type="s", xlab="k", ylab="CDF", lwd=2, main="normal approx. to binomial (CDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_pnorm <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_pnorm, type="l", col="red", lwd=2)
legend(45,0.9, c("binomial", "normal"), col=c("black", "red"), lty=c(1,1), lwd=c(2,2))
dev.off()
n <- 200
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_d <- dbinom(x=x, size=n, prob=p)
plot(x, re_d, type="h", xlab="k", ylab="PDF", main="normal approx. to binomial (PDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_dnorm <- dnorm(x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_dnorm, type="l", col="red", lwd=2)
dev.off()
n <- 200
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_pbinom <- pbinom(q=x, size=n, prob=p)
plot(x, re_pbinom, type="s", xlab="k", ylab="CDF", lwd=2, main="normal approx. to binomial (CDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_pnorm <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_pnorm, type="l", col="red", lwd=2)
legend(45,0.9, c("binomial", "normal"), col=c("black", "red"), lty=c(1,1), lwd=c(2,2))
dev.off()
n <- 200
p <- 0.3
x <- 0:n
pdf("/Users/xdu4/Downloads/binomial.pdf")
re_pbinom <- pbinom(q=x, size=n, prob=p)
plot(x, re_pbinom, type="s", xlab="k", ylab="CDF", lwd=2, main="normal approx. to binomial (CDF)")
mu <- n*p
sigma_squared <- n*p*(1-p)
x <- seq(from=0, to=n, by=0.01)
re_pnorm <- pnorm(q=x, mean=mu, sd=sqrt(sigma_squared))
points(x, re_pnorm, type="l", col="red", lwd=2)
legend("topright", c("binomial", "normal"), col=c("black", "red"), lty=c(1,1), lwd=c(2,2))
dev.off()
f<-function(x){dnorm(x,1.9,0.5)}
plot(f,0,4,xlab="x-axis",ylab="density f(x)")
x<-seq(0,1.4,0.01)
polygon(c(0,x,1.4), c(0,f(x),0), col="lightblue")
graphics.off()
rm(list=ls())
file_path <- "/Users/xdu4/Downloads"
code_path <- "/Users/xdu4/Documents/Duxiuxia/myGitHub/MBWB"
setwd(code_path)
source(paste(code_path, "plotSpectra.R", sep=.Platform$file.sep))
# in_file_name <- "CYSTEINE02.CDF"
# in_file_name <- "2014-0910_4_MeOH,H2O_Ecoli_LowResCID_8MSMS.mzXML"
# scans <- c(2001,2002,2003,2004,2005,2006,2007,2008,2009)
# in_file_name <- "DC12_10SPLIT_CI_1.CDF"
in_file_name <- "150220_EF_PMA_PSN473_LN-1004-f_ddMS2_pos.mzXML"
scans <- 1001:1010
re <- plotSpectra(file_path=file_path, file_name=in_file_name, scans)
source(paste(code_path, "plotSpectra.R", sep=.Platform$file.sep))
# in_file_name <- "CYSTEINE02.CDF"
# in_file_name <- "2014-0910_4_MeOH,H2O_Ecoli_LowResCID_8MSMS.mzXML"
# scans <- c(2001,2002,2003,2004,2005,2006,2007,2008,2009)
# in_file_name <- "DC12_10SPLIT_CI_1.CDF"
in_file_name <- "150220_EF_PMA_PSN473_LN-1004-f_ddMS2_pos.mzXML"
scans <- 1001:1010
re <- plotSpectra(file_path=file_path, file_name=in_file_name, scans)
re <- plotSpectra(file_path=file_path, file_name=in_file_name, scans)
scans <- 1011:1020
re <- plotSpectra(file_path=file_path, file_name=in_file_name, scans)
# plot spectra
source(paste(code_path, "plotSpectra.R", sep=.Platform$file.sep))
scans <- 1011:1020
re <- plotSpectra(file_path=file_path, file_name=in_file_name, scans)
scans <- 1013
re <- plotSpectra(file_path=file_path, file_name=in_file_name, scans)
current_scan_mass <- as.numeric(current_scan_mass)
current_intensity_values <- as.numeric(current_intensity_values)
current_scan_mass
source(paste(code_path, "plotSpectra.R", sep=.Platform$file.sep))
source(paste(code_path, "plotSpectra.R", sep=.Platform$file.sep))
scans <- 1013
re <- plotSpectra(file_path=file_path, file_name=in_file_name, scans)
current_scan[70:70,]
current_scan[70:80,]
current_scan[65:80,]
II <- (current_scan[,1]>216) && (current_scan[,1]<218)
II
II <- which((current_scan[,1]>216) && (current_scan[,1]<218))
II
II <- which((current_scan[,1]>216) & (current_scan[,1]<218))
current_scan[364:373,]
current_scan[360:380,]
II <- which((current_scan[,1]>176) & (current_scan[,1]<180))
current_scan[II,]
II <- which((current_scan[,1]>438) & (current_scan[,1]<441))
current_scan[II,]
II <- which((current_scan[,1]>216) & (current_scan[,1]<218))
current_scan[II,]
719.6/1782
552/1880
252/552
282/719
120/378
195/298
100/195
39/120
298/378
120/195
